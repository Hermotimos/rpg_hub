{% extends 'base.html' %}
{% load static %}
{% load custom_filters %}

{% block head_extra %}
    <link rel="stylesheet" href="{% static 'css/rules.css' %}">
{% endblock head_extra %}

{% block content %}
    <div class="rules-styling">
        <br><br><br>

        <h2 class="rules">Zbroja</h2>
        <br>
        <p>
            Zbroje chronią ciało wojownika przed skutkami trafienia, jednak ze względu na swoją sztywność oraz wagę ograniczają jego ruchy i pole widzenia.
            Cięższe zbroje sprawdzają się w przypadku Postaci, które nie wykorzystują w walce szybkości i zwinności.
        </p>

        <br>
        <table class="plates">
            <colgroup>
                <col class="plate">
                <col class="armor-class">
                <col class="parrying">
                <col class="endurance">
                <col class="weight">
                <col class="agility-penalty">
                <col class="movement-penalty">
            </colgroup>
            <thead class="align-center dark">
                <tr class="border-bottom-dark">
                    <th class="small-caps align-left">ZBROJA</th>
                    <th class="small-caps">KP</th>
                    <th class="small-caps">Wyparowania</th>
                    <th class="small-caps">Wytrzymałość</th>
                    <th class="small-caps">Waga</th>
                    <th class="small-caps">Max premia<br>ze ZRC</th>
                    <th class="small-caps">Max<br>przyspieszenie</th>
                </tr>
            </thead>
            <tbody class="align-center dark">
                {% for plate in plates %}
                    <tr>
                        <td class="{% if plate.description %} hover-blue {% endif %} align-left" data-toggle="collapse" data-target="#{{ plate.short_name }}">{{ plate.name }}</td>
                        <td class="rules-green">{% if plate.armor_class_bonus %} +{{ plate.armor_class_bonus }} {% endif %}</td>
                        <td class="rules-green">{{ plate.parrying }}</td>
                        <td>{{ plate.endurance }}</td>
                        <td>{{ plate.weight.normalize }}</td>
                        <td class="rules-red">{% if plate.mod_max_agility %} {{ plate.mod_max_agility }} {% endif %}</td>
                        <td class="rules-red">{% if plate.mod_max_movement %} {{ plate.mod_max_movement }} {% endif %}</td>
                    </tr>
                    {% if plate.description %}
                        <tr id="{{ plate.short_name }}" class="collapse">
                            <td colspan="10" class="weapons-img px-2 align-left">
                                <br>
                                {{ plate.description|linebreaksbr }}
                                <br><br>
                                <div class="mb-1">
                                    {% for picture_set in plate.picture_sets.all %}
                                        <div class="d-flex justify-content-center my-3">
                                            {% for picture in picture_set|pictureset_pictures_in_custom_order %}
                                                {% include '_pic_with_modal.html' %}
                                            {% endfor %}
                                        </div>
                                    {% endfor %}
                                </div>
                            </td>
                        </tr>
                    {% endif %}
                {% endfor %}
            </tbody>
        </table>

        <br><br>
        <h5><b>Wyparowania i Wytrzymałość zbroi</b></h5>
        <p>
            Oprócz poprawy Klasy Pancerza (KP) każda zbroja posiada współczynnik Wyparowań, który decyduje o tym, ile Obrażeń ulegnie wyhamowaniu i zamiast zranić Postać - uszkodzi jej pancerz.
            Pozwala to na uchronienie się przed częścią, a czasem nawet całością Obrażeń.
            Innymi słowy, Obrażenia można rozdzielić pomiędzy Wytrzymałość Zbroi a Życie Postaci,
            przy czym Zbroja jest w stanie przejąć tylko tyle Obrażeń z jednego ciosu, ile wynosi jej współczynnik Wyparowań.
            Oznacza to konieczność prowadzenia dwóch tabeli Obrażeń: jednej dla Postaci (Obrażenia uszczuplające Życie i podlegające leczeniu)
            oraz dla zbroi (Obrażenia uszczuplające Wytrzymałość i poddające się parokrotnej naprawie u specjalisty).
        </p>
        <p>
            Uszkodzenia zbroi powodują jej stopniową dezintegrację, co zmniejsza jej skuteczność.
            Zbroja pozbawiona ponad połowy Wytrzymałości jest niekompletna i wybrakowana, a przez to pozbawiona Wyparowań, zaś jej Bonus KP zostaje zmniejszony o 1-2.
        </p>
        <p>
            Część broni oraz niektóre Umiejętności dysponują współczynnikiem Przebicia (PRZEB), który pozwala na zignorowanie części lub całości Wyparowań zbroi.
            Np. Przeciwnik zadaje 10 OBR; Postać nosi Kolczugę o Wyparowaniu 3, co pozwalałoby na zmniejszenie OBR do 7;
            jednakże przeciwnik atakował buzdyganem, który ma PRZEB +2;
            ostatecznie więc Kolczuga pozwala na wyparowanie 3 – 2 = 1 OBR; w efekcie Kolczuga otrzymuje -1 Wytrzymałości, a Postać -9 Życia.
        </p>
        
        <br>
        <h5><b>Ograniczenia wynikające z noszenia zbroi</b></h5>
        <p>
            Zbroja w znaczący sposób zmniejsza płynność ruchów Postaci,
            co w przypadku cięższych typów zbroi powoduje ograniczenie premii czerpanych ze ZRC oraz możliwości prędkiego poruszania.
            Przykładowo Postać o ZRC 16 założywszy pełną zbroję płytową może korzystać jedynie z premii dla ZRC 13,
            a jej zdolność do Przyspieszenia (biegu) jest ograniczona do prędkości x3.
        </p>
        <p>
            Poza walką zbroja nie pozostaje bez wpływu na powodzenie działań wymagających wyjątkowej precyzji i dobrego czasu reakcji.
            W związku z tym każda zbroja powoduje malusy do Podstępów.
            Są one ujęte w osobnej tabeli, dlatego nie należy uwzględniać w tym przypadku ograniczeń premii ze ZRC. Byłby to podwójny malus.
        </p>
        <br><br>

        {% include 'rules/_plate_and_tricks_table.html' %}
        
        <br><br><br>


        <h2 class="rules">Tarcza</h2>
        <br>
        <p>
            Poprzez przyjęcie ciosu na tarczę wojownik może uniknąć trafienia przez przeciwnika.
            Liczba przeciwników, przeciwko którym można użyć tarczy jest zależna od jej rodzaju i waha się między 1 a 3.
            Liczba ta wskazuje również, wobec ilu przeciwników można zastosować premie do KP (parowanie) z KON, Walki z tarczą lub inne.
            Postać nie jest w stanie parować ciosów większej liczby przeciwników niż wynika to z opisu danego typu tarczy.
            Tarcza dostarcza także osłony przeciwko atakom dystansowym; wyjątkiem jest puklerz, który nie chroni przed atakami strzeleckimi.
        </p>

        <table class="table table-sm mt-3 shields-table rules-table">
            <thead class="align-center">
                <tr class="border-bottom-dark">
                    <th class="small-caps align-left">Rodzaj</th>
                    <th class="small-caps">KP</th>
                    <th class="small-caps">Waga</th>
                    <th class="small-caps">Specjalne</th>
                </tr>
            </thead>
            <tbody class="align-center">
                {% for shield in shields %}
                    <tr class="">
                        <td class="align-left {% if shield.description %} hover-blue {% endif %}" data-toggle="collapse" data-target="#{{ shield.name }}">
                            {{ shield.name }}
                        </td>
                        <td class="rules-green">+{{ shield.armor_class_bonus }}</td>
                        <td>{{ shield.weight.normalize }}</td>
                        <td>{{ shield.comment }}</td>
                    </tr>
                    {% if shield.description %}
                        <tr id="{{ shield.name }}" class="collapse">
                            <td colspan="10" class="weapons-img px-2 align-left">
                                <br>
                                {{ shield.description|linebreaksbr }}
                                <br><br>
                                <div class="mb-1">
                                    {% if shield.picture_set %}
                                        <div class="d-flex justify-content-center my-3">
                                            {% for picture in shield.picture_set|pictureset_pictures_in_custom_order %}
                                                {% include '_pic_with_modal.html' %}
                                            {% endfor %}
                                        </div>
                                    {% endif %}
                                </div>
                            </td>
                        </tr>
                    {% endif %}
                {% endfor %}
            </tbody>
        </table>

        <br><br><br>


        <h2 class="rules">Hełm i nagolenniki</h2>
        <br>
        <p>
            Hełm i nagolenniki (nagolenice) dostarczają dodatkowej ochrony przeciwko Trafieniu przez przeciwnika.
            Zakres ochrony zależy od tego, czy Postać dysponuje kompletem (hełm + nagolenniki), czy tylko jednym z dwojga.
        </p>
        <br>
        <table class="table table-sm mt-3 shields-table rules-table">
            <thead class="align-center">
                <tr class="border-bottom-dark small-caps">
                    <th class="align-left">Rodzaj</th>
                    <th>Komplet<br>KP</th>
                    <th>Brak Kompletu<br>KP</th>
                    <th>Komplet<br>Waga</th>
                    <th>Brak Kompletu<br>Waga</th>
                </tr>
            </thead>

            <tbody class="align-center">
                <tr><td class="align-left">Skóra</td>               <td class="rules-green">+1</td>    <td class="rules-green">+0</td>    <td class="align-center">2</td>  <td class="align-center">1</td></tr>
                <tr><td class="align-left">Metal</td>               <td class="rules-green">+2</td>    <td class="rules-green">+1</td>    <td class="align-center">4</td>  <td class="align-center">2</td></tr>
                <tr><td class="align-left">Krasnoludzka stal</td>   <td class="rules-green">+3</td>    <td class="rules-green">+2</td>    <td class="align-center">6</td>  <td class="align-center">3</td></tr>
            </tbody>
        </table>
    </div>
{% endblock content %}
