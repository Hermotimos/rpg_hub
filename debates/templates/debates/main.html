{% extends 'base.html' %}
{% load static %}
{% load custom_filters %}

{% block head_extra %}
    <link rel="stylesheet" href="{% static 'css/debates.css' %}">
{% endblock head_extra %}

{% block content %}
    <article class="top-button">
        
        <header class="mb-5">
            <a class="btn btn-outline-dark" href="{% url 'debates:create-topic' %}">Nowy temat</a>
            <a class="btn btn-outline-dark" href="{% url 'debates:create-debate' %}">Nowa narada</a>
        </header>
    
        <article class="pt-5">
            {% for topic in topics %}
                <div id="topic_{{ topic.id }}" class="mb-5">
                    <h3 class="small-caps mb-3">
                        <b class="border-bottom-dark">{{ topic.title }}</b>
                    </h3>
                    {% for debate in topic.debates.all %}
                        <span class="pt-5" id="debate_{{ debate.id }}"></span>
                        <ul class="bullets-3 pl-3 mb-0">
                            <li class="pl-1 pb-2 {% if not debate.is_ended %} bullet-ongoing {% endif %} {% if debate.events.count == 0 %} mb-3 {% endif %}">
                                <div class="d-md-inline">
                                    <h5 class="d-inline font-18">
                                        <a class="pr-1" href="{% url 'debates:debate' debate.id %}">
                                            {{ debate.title }}
                                        </a>
                                    </h5>
                                </div>
                                <div class="d-lg-inline ">
                                    {% for profile in debate.known_directly.all %}
                                        {% if profile.status != 'gm' %}
                                            <img class="rounded-circle img-smaller mb-1 mb-lg-2" src="{{ profile.image.url }}">
                                        {% endif %}
                                    {% endfor %}
                                </div>
                                <div class="d-inline d-sm-block">
                                    <small class="align-top font-11 font-italic text-muted">
                                        {% for event in debate.events.all %}
                                            {% if forloop.counter > 1 %} | {% endif %}
                                            {{ event.game.title }}
                                        {% endfor %}
                                    </small>
                                </div>
                            </li>
                        </ul>
                    {% endfor %}
                </div>
            {% endfor %}
        </article>
        
    </article>
{% endblock content %}