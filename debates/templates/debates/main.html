{% extends 'base.html' %}
{% load static %}
{% load custom_filters %}

{% block head_extra %}
    <link rel="stylesheet" href="{% static 'css/debates.css' %}">
{% endblock head_extra %}

{% block content %}
    <article class="button">
        
        <header class="mb-5">
            <a href="{% url 'debates:create-topic' %}" class="btn btn-outline-dark">Nowy temat narad</a>
        </header>
    
        <article>
            {% for topic in topics %}
                <section>
                    <h3 class="small-caps">
                        <b class="border-bottom-dark">{{ topic.title }}</b>
                    </h3>
                    <a href="{% url 'debates:create-debate' topic.id %}" class="btn btn-outline-dark">Nowa narada</a>
                    <br><br>
                    
                    <ul class="bullets-1">
                        {% for debate in topic.debates.all %}
                            <li class="{% if not debate.is_ended %} bullet-ongoing {% endif %} pb-3">
                                <div class="d-md-inline">
                                    <h5 class="d-sm-inline font-18">
                                        <a class="pr-1" href="{% url 'debates:debate' debate.topic.id debate.id %}">
                                            {{ debate.name }}
                                        </a>
                                    </h5>
                                </div>
                                <div class="d-sm-inline">
                                    {% for profile in debate.allowed_profiles.all %}
                                        {% if profile.status != 'gm' %}
                                            <img class="rounded-circle img-small" src="{{ profile.image.url }}" alt="Profile img">
                                        {% endif %}
                                    {% endfor %}
                                </div>
                                <div class="d-sm-inline d-md-block mt-md-n2">
                                    <small class="font-11 text-muted">
                                        {% if debate.first_player_remark_date|date:'d-M-Y' != debate.last_player_remark_date|date:'d-M-Y' %}
                                           [{{ debate.first_player_remark_date|date:'d/M' }} - {{ debate.last_player_remark_date|date:'d/M Y' }}
                                        {% else %}
                                            [{{ debate.first_player_remark_date|date:'d/M Y' }}
                                        {% endif %}
                                        ✱ Głosy: {{ debate.player_remarks_count }}]
                                    </small>
                                </div>
                            </li>
                        {% endfor %}
                    </ul>
                    <br>
                </section>
            {% endfor %}
        </article>
        
    </article>
{% endblock content %}