{% extends 'base.html' %}
{% load static %}
{% load crispy_forms_tags %}

{% block head_extra %}
    {{ remark_form.media }}
    <link rel="stylesheet" href="{% static 'css/debates.css' %}">
{% endblock head_extra %}

{% block breadcrumb %}
    <li class="breadcrumb-item"><a href="{% url 'debates:main' %}">Narady</a></li>
    <li class="breadcrumb-item active">{{ page_title }}</li>
{% endblock breadcrumb %}

{% block content %}
    <br><br><br>
    <form method="POST" class="allowed-profiles-form-debate">
        {% csrf_token %}

        <!-- NEW TOPIC -->
        {{ topic_form.title|as_crispy_field }}
        {{ topic_form.title.errors }}
        {{ topic_form.description|as_crispy_field }}
        {{ topic_form.description.errors }}<br><br>

        <!-- NEW DEBATE -->
        <fieldset>
            {{ debate_form.name|as_crispy_field }}<br>
            {{ debate_form.name.errors }}

            <h6>Włącz uczestników do narady:</h6>
            <small>1) Włączaj tylko postacie znajdujące się w pobliżu w chwili zakończenia ostatniej sesji.</small><br>
            <small>2) Postacie będące w pobliżu, ale nie włączone do narady, mogą to zauważyć.</small><br>
            <small>3) Jeśli chcesz zaczekać na sposobny moment, powiadom MG.</small><br>
            <small>4) Jeśli chcesz się naradzić z postacią, której nie ma na liście, powiadom MG.</small>

            <br><br>
            {{ debate_form.allowed_profiles|as_crispy_field }}
            <small>***Aby zaznaczyć wiele postaci - użyj CTRL albo SHIFT.</small><br><br>
        </fieldset>

        {% if request.user.profile.character_status == 'gm' %}
            {{ debate_form.is_individual|as_crispy_field }}<br>
        {% endif %}

        <!-- NEW REMARK -->
        <div class="form-row">
            <div class="form-group col-md-2 mb-0">
                {% if request.user.profile.character_status == 'gm' %}
                    {{ remark_form.author|as_crispy_field }}
                {% else %}
                <div class="collapse">
                    {{ remark_form.author }}
                </div>
                {% endif %}
                {{ remark_form.author.errors }}
            </div>
            <div class="form-group col-md-10 mb-0">
                {{ remark_form.text|as_crispy_field }}
            </div>
        </div>
        {{ remark_form.image|as_crispy_field }}

        <input class="btn btn-dark" type="submit" value="Stwórz temat i zapoczątkuj naradę"/>
    </form>
{% endblock content %}
