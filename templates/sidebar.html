{% load static %}

{% block head_extra %}
    <link rel="stylesheet" href="{% static 'css/sidebar.css' %}">
    <script src="{% static 'js/showTime.js' %}"></script>
{% endblock head_extra %}

<div class="content-section-sidebar">
    <aside>
        <img class="account-img-sidebar mb-1" onload="showTime()" src="{{ current_profile.image.url }}">
        <h3 class="mb-4 text-center">
            
            <!-- TODO del condition when ready -->
            {% if current_profile.user.username != 'Marta' and current_profile.user.username != 'Dawid' and current_profile.user.username != 'Hubert' and current_profile.user.username != 'Tomek' %}
                <a href="{% url 'prosoponomikon:character' current_profile.character.id %}">
                   {{ current_profile.character.fullname }}
                </a>
            {% else %}
                {{ current_profile.character.fullname }}
            {% endif %}
        </h3>
        
        <!-- For game master -->
        {% if current_profile.status == 'gm' %}
            <ul class="list-group hover-pointer">
                <li class="list-group-item list-group-item-light small-caps" data-toggle="collapse" data-target="#technical"><h6 class="mb-0">Techniczne</h6></li>
                <li id="technical" class="list-group collapse">
                    <div class="overflow-auto border" style="max-height: 15rem;">
                        <a class="list-group-item list-group-item-light" href="{% url 'admin:index' %}" target="_blank" rel="noopener noreferrer"><small>ADMIN</small></a>
                        <a class="list-group-item list-group-item-light" href="{% url 'contact:plans-main' %}"><small>Plany MG</small></a>
                        <a class="list-group-item list-group-item-light" href="{% url 'technicalities:todos' %}"><small>TODOs</small></a>
                        <a class="list-group-item list-group-item-light" href="{% url 'technicalities:reload-main' %}"><small>Przeładowanie modeli w aplikacjach</small></a>
                    </div>
                </li>
            </ul>
            <ul class="list-group hover-pointer">
                <li class="list-group-item list-group-item-light small-caps" data-toggle="collapse" data-target="#world"><h6 class="mb-0">Świat</h6></li>
                <li id="world" class="list-group collapse">
                    <div class="overflow-auto border" style="max-height: 15rem;">
                        <a class="list-group-item list-group-item-light" href="{% url 'chronicles:chronologies' %}">
                            <small>Chronologie</small>
                        </a>
                        <a class="list-group-item list-group-item-light" href="{% url 'prosoponomikon:first-names' %}" target="_blank" rel="noopener noreferrer">
                            <small>Imiona</small>
                        </a>
                        <a class="list-group-item list-group-item-light" href="{% url 'prosoponomikon:family-names' %}" target="_blank" rel="noopener noreferrer">
                            <small>Nazwiska</small>
                        </a>
                        <a class="list-group-item list-group-item-light" href="{% url 'prosoponomikon:character-create' %}" target="_blank" rel="noopener noreferrer">
                            <small>+ Postać</small>
                        </a>
                    </div>
                </li>
            </ul>
        {% endif %}
        
        <ul class="list-group hover-pointer">
            <li class="list-group-item list-group-item-light small-caps" data-toggle="collapse" data-target="#profiles"><h6 class="mb-0">Postacie</h6></li>
            <li id="profiles" class="list-group collapse">
                <div class="overflow-auto border" style="max-height: 15rem;">
                    {% for profile in user.get_profiles %}
                        <a class="list-group-item list-group-item-light" href="{% url 'users:switch-profile' profile.id %}">
                            <small>{{ profile.character.fullname }}</small>
                        </a>
                    {% endfor %}
                </div>
            </li>
        </ul>
        
        {% if current_profile.status == 'gm' and '127.0.0.1' in request.get_host%}
            <div class="mt-2 ml-1 mr-n1 d-flex flex-wrap">
                <div class="mr-md-auto py-1 px-1 px-md-0">
                    <a class="btn btn-outline-secondary icon-database-backup py-2" href="{% url 'technicalities:backup-db' %}"
                        data-toggle="tooltip" data-placement="bottom" title="wykonaj lokalny backup bazy GCP">
                    </a>
                </div>
                <div class="mr-md-auto py-1 px-1 px-md-0">
                    <a class="btn btn-outline-info icon-download-cloud py-2" href="{% url 'technicalities:update-local-db' %}"
                       onclick="return confirm('Potwierdź nadpisanie bazy lokalnej przez bazę produkcyjną!');"
                       data-toggle="tooltip" data-placement="bottom" title="GCP --> LOCAL">
                    </a>
                </div>
                <div class="mr-md-auto py-1 px-1 px-md-0">
                    <a class="btn btn-outline-danger icon-upload-cloud py-2" href="{% url 'technicalities:update-prod-db' %}"
                       onclick="return confirm('Potwierdź nadpisanie bazy PRODUKCYJNEJ przez bazę lokalną!');"
                       data-toggle="tooltip" data-placement="bottom" title="LOCAL --> GCP">
                    </a>
                </div>
                <div class="mr-md-auto py-1 px-1 px-md-0">
                    <a class="btn btn-outline-secondary icon-cloud py-2" href="https://console.cloud.google.com/home"
                       data-toggle="tooltip" data-placement="bottom" title="Idź do konsoli GCP">
                    </a>
                </div>
            </div>
        {% endif %}
        
        <br>
    </aside>
</div>
